<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>Renuar Finder</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: url('https://img.freepik.com/free-photo/clothing-store-interior-modern-shopping-mall_1232-4297.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #222;
      text-align: center;
    }
    header {
      background: rgba(0, 51, 102, 0.85);
      color: white;
      padding: 15px;
      font-size: 24px;
      font-weight: bold;
    }
    main {
      padding: 20px;
      background: rgba(255,255,255,0.9);
      margin: 30px auto;
      max-width: 700px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    input, button {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    button {
      background: #003366;
      color: white;
      cursor: pointer;
      border: none;
      transition: 0.3s;
    }
    button:hover {
      background: #0055aa;
    }
    #results, #localList {
      margin-top: 20px;
      text-align: left;
      background: #f9f9f9;
      padding: 10px;
      border-radius: 5px;
    }
    #hostArea {
      margin-top: 20px;
      background: #eef;
      padding: 15px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <header>ğŸ” ×—×™×¤×•×© ×¤×¨×™×˜×™× - Renuar Finder</header>

  <main>
    <h2>×—×¤×© ×¤×¨×™×˜ ×œ×¤×™ ××§×´×˜ ××• ×©×</h2>
    <input id="searchInput" type="text" placeholder="×”×–×Ÿ ××§×´×˜ ××• ×©× ×¤×¨×™×˜">
    <br>
    <button id="btnLocal">×—×¤×© ××§×•××™</button>
    <button id="btnRenuar">×—×¤×© ×‘×¨× ×•××¨</button>
    <button id="btnHome">×¤×ª×— ××ª×¨ ×¨× ×•××¨</button>
    <button id="btnClear">× ×§×”</button>
    <p id="msg"></p>

    <div id="results"></div>
    <div id="localList"></div>

    <hr>

    <div id="loginBox">
      <h3>ğŸ”‘ ×›× ×™×¡×ª Host</h3>
      <input id="hostPass" type="password" placeholder="×¡×™×¡××ª Host">
      <button id="btnLogin">×”×ª×—×‘×¨</button>
    </div>

    <div id="hostArea" style="display:none;">
      <h3>â• ×”×•×¡×¤×ª ××•×¦×¨ ×—×“×©</h3>
      <input id="sku" placeholder="××§×´×˜"><br>
      <input id="name" placeholder="×©×"><br>
      <input id="price" placeholder="××—×™×¨"><br>
      <input id="link" placeholder="×§×™×©×•×¨ (×œ× ×—×•×‘×”)"><br>
      <button id="btnAdd">×”×•×¡×£ ××•×¦×¨</button>
    </div>
  </main>

  <script>
  /* ============ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ ============ */
  const LS_KEY = 'renuarDB';
  const HOST_PASS = '1234'; // ØºÙŠÙ‘Ø±Ù‡Ø§ Ø¥Ù† Ø£Ø±Ø¯Øª
  let DB = [];
  try { DB = JSON.parse(localStorage.getItem(LS_KEY) || '[]'); } catch { DB = []; }

  /* ============ Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø© ============ */
  const $ = (sel, root=document) => root.querySelector(sel);
  const byId = id => document.getElementById(id) || null;
  function setText(idOrEl, text) {
    const el = typeof idOrEl === 'string' ? byId(idOrEl) : idOrEl;
    if (el) el.textContent = text;
  }
  function normalize(str) {
    return (str || '').replace(/[\u0591-\u05C7]/g, '').replace(/\s+/g, ' ').trim().toLowerCase();
  }

  /* ============ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ============ */
  function renUrl(q) {
    return 'https://www.renuar.co.il/catalogsearch/result/?q=' + encodeURIComponent(q);
  }
  function renderList(items) {
    const cont = byId('results') || byId('localList');
    if (!cont) return;
    if (!items || !items.length) { cont.innerHTML = '××™×Ÿ ×ª×•×¦××•×ª ×¢×“×™×™×Ÿ.'; return; }
    cont.innerHTML = items.map(p => `
      <p><b>${p.name || ''}</b> (SKU: ${p.sku || ''}) â€” â‚ª${p.price || '-'}
      ${p.link ? ` â€” <a href="${p.link}" target="_blank" rel="noopener">×§×™×©×•×¨</a>` : ''}</p>
    `).join('');
  }
  function readQuery() {
    const inp = byId('searchInput') || byId('q');
    return normalize(inp && inp.value);
  }

  /* Ø¨Ø­Ø« Ù…Ø­Ù„ÙŠ */
  function searchLocal() {
    const q = readQuery();
    const info = byId('msg');
    if (!q) { if (info) info.style.color='red', info.textContent='× × ×œ×”×–×™×Ÿ ××§×´×˜ ××• ×©×'; return; }
    const hits = DB.filter(p => {
      const sku = String(p.sku || '').toLowerCase();
      const name = normalize(p.name);
      return sku === q || sku.includes(q) || (name && name.includes(q));
    });
    renderList(hits);
    if (info) info.style.color='#555', info.textContent = hits.length ? '× ××¦× ×‘××—×™×¨×•×Ÿ ×”××§×•××™.' : '×œ× × ××¦××” ×ª×•×¦××” ××§×•××™×ª.';
  }

  /* ÙØªØ­ Ù†ØªØ§Ø¦Ø¬ ×¨× ×•××¨ */
  function searchRenuar() {
    const raw = (byId('searchInput') || { value:'' }).value.trim();
    if (!raw) { setText('msg', '× × ×œ×”×–×™×Ÿ ×¢×¨×š'); return; }
    window.open(renUrl(raw), '_blank', 'noopener');
  }

  /* ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
  function openRenuar() {
    window.open('https://www.renuar.co.il/home', '_blank', 'noopener');
  }

  /* ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø¶Ø§ÙØ© Ø¹Ù†Ø§ØµØ± Ù„Ù„Ù€Host */
  let isHost = false;
  function hostLogin() {
    const pass = (byId('hostPass') || { value:'' }).value;
    if (pass === HOST_PASS) {
      isHost = true;
      if (byId('hostArea')) byId('hostArea').style.display = 'block';
      if (byId('loginBox')) byId('loginBox').style.display = 'none';
    } else { alert('×¡×™×¡××” ×œ× × ×›×•× ×”'); }
  }
  function addItem() {
    if (!isHost) return alert('×¨×§ Host ×™×›×•×œ ×œ×”×•×¡×™×£');
    const sku   = (byId('sku')   || {value:''}).value.trim();
    const name  = (byId('name')  || {value:''}).value.trim();
    const price = (byId('price') || {value:''}).value.trim();
    const link  = (byId('link')  || {value:''}).value.trim();
    if (!sku || !name || !price) return alert('××œ× ××§×´×˜/×©×/××—×™×¨');
    DB.push({ sku, name, price, link });
    localStorage.setItem(LS_KEY, JSON.stringify(DB));
    ['sku','name','price','link'].forEach(id => { const el = byId(id); if (el) el.value=''; });
    renderList(DB);
    alert('âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©');
  }

  /* ØªÙ†Ø¸ÙŠÙ */
  function clearAll() {
    const inp = byId('searchInput');
    if (inp) inp.value = '';
    const res = byId('results');
    if (res) res.innerHTML = '';
    setText('msg', 'ØªÙ… Ø§Ù„Ù…Ø³Ø­. Ø§ÙƒØªØ¨ Ù‚ÙŠÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©.');
  }

  /* ============ Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± ============ */
  function safeBind(id, fn) {
    const el = byId(id);
    if (el) el.addEventListener('click', e => { e.preventDefault(); try{ fn(); }catch(err){ console.error(err); alert('Ø­Ø¯Ø« Ø®Ø·Ø£'); } });
  }
  document.addEventListener('DOMContentLoaded', () => {
    const inp = byId('searchInput');
    if (inp) inp.addEventListener('keydown', e => { if (e.key === 'Enter') { e.preventDefault(); searchLocal(); } });
    safeBind('btnLocal', searchLocal);
    safeBind('btnRenuar', searchRenuar);
    safeBind('btnHome', openRenuar);
    safeBind('btnClear', clearAll);
    safeBind('btnLogin', hostLogin);
    safeBind('btnAdd', addItem);
    renderList(DB);
  });
  </script>
</body>
</html>
